:: Widgets Tentacle Actions Generation [widget]

/*Sends the required variables to the chosen display type*/
<<widget "generateCombatActionTentacle">><<nobr>>
<<switch $combatControls>>
	<<case "radio">>
		<<generateCombatActionTentacleRadio $args[0] $args[1] $args[3]>>
	<<case "lists" "limitedLists">>
		<<generateCombatActionTentacleList $args[0] $args[1] $args[2] $args[4]>>
<</switch>>
<</nobr>><</widget>>

/*Generated each set of actions in the form of a set of radio buttons*/
<<widget "generateCombatActionTentacleRadio">><<nobr>>
<<for _labelC, _valueC range $args[0]>>
	<label>
		<<print '<<radiobutton "$'+$args[1]+'" "'+_valueC+'" ' + (_valueC is $args[2] ? "checked" : "") + '>>'>>
		<span @class="combatListColor('', _valueC, 'Tentacle')"><<print _labelC>></span>
		<<print '<<'+$args[1]+'DifficultyTentacle "'+_valueC+'">>'>> |
	</label>
<</for>>
<</nobr>><</widget>>

/*Generated each set of actions in the form of a list*/
<<widget "generateCombatActionTentacleList">><<nobr>>
<<if $args[0]>>
	<<set _options to $args[0]>>
	<<set _name to $args[1]>>
	<<capture _var _options _name>>
		<span @id="_name + 'Select'" @class="$args[2] + 'List flavorText '+($args[3] is true?'reducedWidth':'')">
			<<listbox `"$"+_name` autoselect>>
				<<optionsfrom _options>>
			<</listbox>>
		</span>
		/*Changes the color of the list border when the option is changed*/
		<<combatButtonAdjustments _name "Tentacle">>
	<</capture>>
<</if>>
<</nobr>><</widget>>

<<widget "generateActionsTentacle">><<nobr>>
<div id="listContainer">
	<div id="leftaction" @class="$combatControls + 'Control'">
		<<leftActionInitTentacle>>
	</div>

	<div id="rightaction" @class="$combatControls + 'Control'">
		<<rightActionInitTentacle>>
	</div>

	<div id="feetaction" @class="$combatControls + 'Control'">
		<<feetActionInitTentacle>>
	</div>

	<<if $mouthstate isnot 0>>
		<div id="mouthaction" @class="$combatControls + 'Control'">
			<<mouthActionInitTentacle>>
		</div>
	<</if>>
	<<if $penisstate isnot 0 and $penisexist is 1>>
		<div id="penisaction" @class="$combatControls + 'Control'">
			<<penisActionInitTentacle>>
		</div>
	<</if>>
	<<if $vaginastate isnot 0 and $vaginaexist is 1>>
		<div id="vaginaaction" @class="$combatControls + 'Control'">
			<<vaginaActionInitTentacle>>
		</div>
	<</if>>
	<<if $anusstate isnot 0>>
		<div id="anusaction" @class="$combatControls + 'Control'">
			<<anusActionInitTentacle>>
		</div>
	<</if>>
	<<if $breastuse isnot 0>>
		<div id="chestaction" @class="$combatControls + 'Control'">
			<<chestActionInitTentacle>>
		</div>
	<</if>>
</div>
<</nobr>><</widget>>

<<widget "leftActionInitTentacle">><<nobr>>
	<<switch $leftarm>>
		<<case 0>>
			<<set _leftOptions to "free">>
			<span @class="($lastOptions.left isnot _leftOptions ?'gold':'')">Your left arm is free.</span>
		<<case "grappled">>
			<<set _leftOptions to "grappled">>
			<<for _i to 0; _i lt $tentacles.max; _i++>>
				<<if $tentacles[_i].shaft is "leftarm">>
					<span @class="($lastOptions.left isnot _leftOptions ?'gold':'')">The $tentacles[_i].desc tentacle entangles your left arm.</span>
					<<break>>
				<</if>>
			<</for>>
		<<case "bound">>
			<<set _leftOptions to "bound">>
			<span @class="($lastOptions.left isnot _leftOptions ?'gold':'')">Your left arm is bound.</span>
		<<case "trapped">>
			<<set _leftOptions to "trapped">>
			<span @class="($lastOptions.left isnot _leftOptions ?'gold':'purple')">Your left arm is trapped by the $vorecreature.</span>
		<<default>>
			<<for _i to 0; _i lt $tentacles.max; _i++>>
				<<if $leftarm is $tentacles[_i].id>>
					<<set _leftOptions to "tentacle">>
					<<set _tentacleLeftOption to $tentacles[_i].id>>
					<span @class="($lastOptions.left isnot _leftOptions ?'gold':'')">You hold the $tentacles[_i].desc tentacle in your left hand.</span>
					<<break>>
				<</if>>
			<</for>>
	<</switch>>
	<<leftActionsTentacle>>
	<<if Object.keys(_leftaction).length gt 0>>
		<<if Object.values(_leftaction).includes($leftactiondefault) is false or $args[0] is true or ["rest","leftgrab"].includes($leftactiondefault)>>
			<<set _defaultsCombatAction to "leftaction">>
			<<set _actionsSet to $actionDefaults.Tentacles[$defaultsCombatType][_defaultsCombatAction]>>
			<<set _pass to false>>
			<<for _set to 0; _set lt $maxDefaultActionSets; _set++>>
				<<if ["leftgrab"].includes(_actionsSet[_set]) and $leftactionTarget isnot undefined>>
					<<for _i to 0; _i lt $tentacles.max; _i++>>
						<<if $tentacles[_i].shaft isnot "finished">>
							<<if $regrab and $tentacles[_i].head is 0>>
								<<set $leftactiondefault to clone(_actionsSet[_set])>>
								<<set $leftactionTarget to $tentacles[_i].id>>
								<<set _pass to true>>
								<<break>>
							<<elseif $tentacles[_i].head is 0>>
								<<set $leftactiondefault to clone(_actionsSet[_set])>>
								<<set _pass to true>>
							<</if>>
							<<if $regrab is false>>
								<<break>>
							<</if>>
						<</if>>
					<</for>>
				<<elseif ["leftrub","showpenis","showvagina","showbottom"].includes(_actionsSet[_set]) and _tentacleLeftOption isnot undefined>>
					<<if Object.values(_leftaction).includes(_actionsSet[_set] + _tentacleLeftOption)>>
						<<set $leftactiondefault to clone(_actionsSet[_set] + _tentacleLeftOption)>>
						<<set _pass to true>>
						<<break>>
					<</if>>
				<<elseif Object.values(_leftaction).includes(_actionsSet[_set])>>
					<<set $leftactiondefault to clone(_actionsSet[_set])>>
					<<set _pass to true>>
					<<break>>
				<</if>>
			<</for>>
			<<if _pass is false>>
				<<set $leftactiondefault to Object.values(_leftaction)[0]>>
			<</if>>
		<</if>>
		<<set $leftaction to $leftactiondefault>>
		<<set _textColor to combatListColor('leftaction', (Object.values(_leftaction).includes($leftaction) ? $leftaction : Object.values(_leftaction)[0]), "Tentacle")>>
		<div class="extraMargin">
			<<if $combatControls isnot "radio" and _leftOptions is "free">>
				<<set _reducedWidths to true>>
			<<else>>
				<<set _reducedWidths to false>>
			<</if>>
			<<generateCombatActionTentacle _leftaction "leftaction" _textColor $leftaction _reducedWidths>>
			<<if _leftOptions is "free" and $tentacles.active gt 0>>
				<<leftactionSetupTentacle>>
			<</if>>
		</div>
		<<if $combatControls.includes("ists")>>
			<div id="leftactionDifficulty">
				<<leftactionDifficultyTentacle>>
			</div>
		<</if>>
	<</if>>
	<<set $lastOptions.left to clone(_leftOptions)>>
<</nobr>><</widget>>

<<widget "leftactionSetupTentacle">><<nobr>>
<<if $combatControls is "radio">>
	<br><br>
	<<set _first to true>>
	<<if $regrab>>
		<<for _i to 0; _i lt $tentacles.max; _i++>>
			<<if $tentacles[_i] isnot undefined>>
				<<if $tentacles[_i].shaft isnot "finished" and $tentacles[_i].id is $leftactionTarget>>
					<<set _first to false>>
					<<set $_found to $tentacles[_i].id>>
					<<break>>
				<</if>>
			<</if>>
		<</for>>
	<</if>>
	<<for _i to 0; _i lt $tentacles.max; _i++>>
		<<if $tentacles[_i] isnot undefined>>
			<<if $tentacles[_i].shaft isnot "finished">>
				<label>
					<<print '<<radiobutton "$leftactionTarget" "'+$tentacles[_i].id+'" ' + (_first is true or $tentacles[_i].id is $_found ? "checked" : "") + '>>'>>
					$tentacles[_i].fullDesc
				</label> |
				<<set _first to false>>
			<</if>>
		<</if>>
	<</for>>
<<else>>
	<<if _availableTargets is undefined>>
		<<if $controls is "radio">>
			<br>
		<</if>>
		<<set _availableTargets to {}>>
		<<for _i to 0; _i lt $tentacles.max; _i++>>
			<<if $tentacles[_i] isnot undefined>>
				<<if $tentacles[_i].shaft isnot "finished">>
					<<set _availableTargets[$tentacles[_i].desc+" tentacle"] to $tentacles[_i].id>>
					<<set _tentacle_targets_available to true>>
				<</if>>
			<</if>>
		<</for>>
	<</if>>
	<<if _tentacle_targets_available>>
		<span @class="'whiteList ' + (_reducedWidths is true? 'reducedWidth':'')">
			<<listbox "$leftactionTarget" autoselect>>
				<<optionsfrom _availableTargets>>
			<</listbox>>
		</span>
	<</if>>
<</if>>
<</nobr>><</widget>>

<<widget "leftactionDifficultyTentacle">><<nobr>>
<<if $args[0] is undefined>>
	<<set _diffAction to $leftaction>>
<<else>>
	<<set _diffAction to $args[0]>>
<</if>>
<<switch (""+_diffAction).replace(/\d+/g,'')>>
	<<case "showbottomtentacle" "showthighstentacle" "showmouthtentacle" "showpenistentacle" "showvaginatentacle">><<deviant5>>
<</switch>>
<</nobr>><</widget>>

<<widget "leftActionsTentacle">><<nobr>>
/*Generate Actions*/
<<set _leftaction to {}>>
<<set _leftaction["Rest"] to "rest">>
<<switch _leftOptions>>
	<<case "free">>
		<<if $vorecreature>>
			<<set _leftaction["Escape the "+$vorecreature] to "leftescape">>
			<<if $vorestage lte 6>>
				<<set _leftaction["Hold on to the "+$vorecreature] to "lefthold">>
			<</if>>
			<<if $rightarm is "trapped">>
				<<set _leftaction["Free your right arm"] to "leftvorefree">>
			<</if>>
		<</if>>
		<<if $tentacles.active gt 0>>
			<<if $consensual is 0>>
				<<set _leftaction["Strike the"] to "lefthit">>
			<</if>>
			<<set _leftaction["Grab the"] to "leftgrab">>
		<</if>>
	<<case "grappled">>
	<<case "bound">>
	<<case "tentacle">>
		<<set _leftaction["Milk it"] to "leftrub"+_tentacleLeftOption>>
		<<set _leftaction["Let go"] to "leftstop"+_tentacleLeftOption>>
		<<if $deviancy gte 75>>
			<<if $penisexist is 1 and $penisuse is 0>>
				<<set _leftaction["Guide to your penis"] to "showpenis"+_tentacleLeftOption>>
			<</if>>
			<<if $vaginaexist is 1 and $vaginause is 0>>
				<<set _leftaction["Guide to your pussy"] to "showvagina"+_tentacleLeftOption>>
			<</if>>
			<<if $anususe is 0 and $analdisable is "f">>
				<<set _leftaction["Guide to your ass"] to "showbottom"+_tentacleLeftOption>>
			<</if>>
			/* Old Control
			<<if ($vaginaexist is 1 and $vaginause is 0) or ($penisexist is 1 and $penisuse is 0)>>
				<<set _leftaction["Guide to your thighs"] to "showthighs"+_tentacleLeftOption>>
			<</if>>*/
			<<if $mouthuse is 0>>
				<<set _leftaction["Guide to your mouth"] to "showmouth"+_tentacleLeftOption>>
			<</if>>
		<</if>>
<</switch>>
<</nobr>><</widget>>

<<widget "rightActionInitTentacle">><<nobr>>
	<<switch $rightarm>>
		<<case 0>>
			<<set _rightOptions to "free">>
			<span @class="($lastOptions.right isnot _rightOptions ?'gold':'')">Your right arm is free.</span>
		<<case "grappled">>
			<<set _rightOptions to "grappled">>
			<<for _i to 0; _i lt $tentacles.max; _i++>>
				<<if $tentacles[_i].shaft is "rightarm">>
					<span @class="($lastOptions.right isnot _rightOptions ?'gold':'')">The $tentacles[_i].desc tentacle entangles your right arm.</span>
					<<break>>
				<</if>>
			<</for>>
		<<case "bound">>
			<<set _rightOptions to "bound">>
			<span @class="($lastOptions.right isnot _rightOptions ?'gold':'')">Your right arm is bound.</span>
		<<case "trapped">>
			<<set _rightOptions to "trapped">>
			<span @class="($lastOptions.right isnot _rightOptions ?'gold':'purple')">Your right arm is trapped by the $vorecreature.</span>
		<<default>>
			<<for _i to 0; _i lt $tentacles.max; _i++>>
				<<if $rightarm is $tentacles[_i].id>>
					<<set _rightOptions to "tentacle">>
					<<set _tentaclerightOption to $tentacles[_i].id>>
					<span @class="($lastOptions.right isnot _rightOptions ?'gold':'')">You hold the $tentacles[_i].desc tentacle in your right hand.</span>
					<<break>>
				<</if>>
			<</for>>
	<</switch>>
	<<rightActionsTentacle>>
	<<if Object.keys(_rightaction).length gt 0>>
		<<if Object.values(_rightaction).includes($rightactiondefault) is false or $args[0] is true or ["rest","rightgrab"].includes($rightactiondefault)>>
			<<set _defaultsCombatAction to "rightaction">>
			<<set _actionsSet to $actionDefaults.Tentacles[$defaultsCombatType][_defaultsCombatAction]>>
			<<set _pass to false>>
			<<for _set to 0; _set lt $maxDefaultActionSets; _set++>>
				<<if ["rightgrab"].includes(_actionsSet[_set]) and $rightactionTarget isnot undefined>>
					<<for _i to 0; _i lt $tentacles.max; _i++>>
						<<if $tentacles[_i].shaft isnot "finished">>
							<<if $regrab and $tentacles[_i].head is 0>>
								<<set $rightactiondefault to clone(_actionsSet[_set])>>
								<<set $rightactionTarget to $tentacles[_i].id>>
								<<set _pass to true>>
								<<break>>
							<<elseif $tentacles[_i].head is 0>>
								<<set $rightactiondefault to clone(_actionsSet[_set])>>
								<<set _pass to true>>
							<</if>>
							<<if $regrab is false>>
								<<break>>
							<</if>>
						<</if>>
					<</for>>
				<<elseif ["rightrub","showpenis","showvagina","showbottom"].includes(_actionsSet[_set]) and _tentaclerightOption isnot undefined>>
					<<if Object.values(_rightaction).includes(_actionsSet[_set] + _tentaclerightOption)>>
						<<set $rightactiondefault to clone(_actionsSet[_set] + _tentaclerightOption)>>
						<<set _pass to true>>
						<<break>>
					<</if>>
				<<elseif Object.values(_rightaction).includes(_actionsSet[_set])>>
					<<set $rightactiondefault to clone(_actionsSet[_set])>>
					<<set _pass to true>>
					<<break>>
				<</if>>
			<</for>>
			<<if _pass is false>>
				<<set $rightactiondefault to Object.values(_rightaction)[0]>>
			<</if>>
		<</if>>
		<<set $rightaction to $rightactiondefault>>
		<<set _textColor to combatListColor('rightaction', (Object.values(_rightaction).includes($rightaction) ? $rightaction : Object.values(_rightaction)[0]), "Tentacle")>>
		<div class="extraMargin">
			<<if $combatControls isnot "radio" and _rightOptions is "free">>
				<<set _reducedWidths to true>>
			<<else>>
				<<set _reducedWidths to false>>
			<</if>>
			<<generateCombatActionTentacle _rightaction "rightaction" _textColor $rightaction _reducedWidths>>
			<<if _rightOptions is "free" and $tentacles.active gt 0>>
				<<rightactionSetupTentacle>>
			<</if>>
		</div>
		<<if $combatControls.includes("ists")>>
			<div id="rightactionDifficulty">
				<<rightactionDifficultyTentacle>>
			</div>
		<</if>>
	<</if>>
	<<set $lastOptions.right to clone(_rightOptions)>>
<</nobr>><</widget>>

<<widget "rightactionSetupTentacle">><<nobr>>
<<if $combatControls is "radio">>
	<br><br>
	<<set _first to true>>
	<<if $regrab>>
		<<for _i to 0; _i lt $tentacles.max; _i++>>
			<<if $tentacles[_i] isnot undefined>>
				<<if $tentacles[_i].shaft isnot "finished" and $tentacles[_i].id is $rightactionTarget>>
					<<set _first to false>>
					<<set $_found to $tentacles[_i].id>>
					<<break>>
				<</if>>
			<</if>>
		<</for>>
	<</if>>
	<<for _i to 0; _i lt $tentacles.max; _i++>>
		<<if $tentacles[_i] isnot undefined>>
			<<if $tentacles[_i].shaft isnot "finished">>
				<label>
					<<print '<<radiobutton "$rightactionTarget" "'+$tentacles[_i].id+'" ' + (_first is true or $tentacles[_i].id is $_found ? "checked" : "") + '>>'>>
					$tentacles[_i].fullDesc
				</label> |
				<<set _first to false>>
			<</if>>
		<</if>>
	<</for>>
<<else>>
	<<if _availableTargets is undefined>>
		<<if $controls is "radio">>
			<br>
		<</if>>
		<<set _availableTargets to {}>>
		<<for _i to 0; _i lt $tentacles.max; _i++>>
			<<if $tentacles[_i] isnot undefined>>
				<<if $tentacles[_i].shaft isnot "finished">>
					<<set _availableTargets[$tentacles[_i].desc+" tentacle"] to $tentacles[_i].id>>
					<<set _tentacle_targets_available to true>>
				<</if>>
			<</if>>
		<</for>>
	<</if>>
	<<if _tentacle_targets_available>>
		<span @class="'whiteList ' + (_reducedWidths is true? 'reducedWidth':'')">
			<<listbox "$rightactionTarget" autoselect>>
				<<optionsfrom _availableTargets>>
			<</listbox>>
		</span>
	<</if>>
<</if>>
<</nobr>><</widget>>

<<widget "rightactionDifficultyTentacle">><<nobr>>
<<if $args[0] is undefined>>
	<<set _diffAction to $rightaction>>
<<else>>
	<<set _diffAction to $args[0]>>
<</if>>
<<switch (""+_diffAction).replace(/\d+/g,'')>>
	<<case "showbottomtentacle" "showthighstentacle" "showmouthtentacle" "showpenistentacle" "showvaginatentacle">><<deviant5>>
<</switch>>
<</nobr>><</widget>>

<<widget "rightActionsTentacle">><<nobr>>
/*Generate Actions*/
<<set _rightaction to {}>>
<<set _rightaction["Rest"] to "rest">>
<<switch _rightOptions>>
	<<case "free">>
		<<if $vorecreature>>
			<<set _rightaction["Escape the "+$vorecreature] to "rightescape">>
			<<if $vorestage lte 6>>
				<<set _rightaction["Hold on to the "+$vorecreature] to "righthold">>
			<</if>>
			<<if $rightarm is "trapped">>
				<<set _rightaction["Free your left arm"] to "rightvorefree">>
			<</if>>
		<</if>>
		<<if $tentacles.active gt 0>>
			<<if $consensual is 0>>
				<<set _rightaction["Strike the"] to "righthit">>
			<</if>>
			<<set _rightaction["Grab the"] to "rightgrab">>
		<</if>>
	<<case "grappled">>
	<<case "bound">>
	<<case "tentacle">>
		<<set _rightaction["Milk it"] to "rightrub"+_tentaclerightOption>>
		<<set _rightaction["Let go"] to "rightstop"+_tentaclerightOption>>
		<<if $deviancy gte 75>>
			<<if $penisexist is 1 and $penisuse is 0>>
				<<set _rightaction["Guide to your penis"] to "showpenis"+_tentaclerightOption>>
			<</if>>
			<<if $vaginaexist is 1 and $vaginause is 0>>
				<<set _rightaction["Guide to your pussy"] to "showvagina"+_tentaclerightOption>>
			<</if>>
			<<if $anususe is 0 and $analdisable is "f">>
				<<set _rightaction["Guide to your ass"] to "showbottom"+_tentaclerightOption>>
			<</if>>
			/* Old controls
			<<if ($vaginaexist is 1 and $vaginause is 0) or ($penisexist is 1 and $penisuse is 0)>>
				<<set _rightaction["Guide to your thighs"] to "showthighs"+_tentaclerightOption>>
			<</if>>*/
			<<if $mouthuse is 0>>
				<<set _rightaction["Guide to your mouth"] to "showmouth"+_tentaclerightOption>>
			<</if>>
		<</if>>
<</switch>>
<</nobr>><</widget>>

<<widget "feetActionInitTentacle">><<nobr>>
	<<if $leftleg is 0 and $rightleg is 0>>
		<<set _feetOptions to "free">>
		<span @class="($lastOptions.feet isnot _feetOptions ?'gold':'')">Your legs are free.</span>
	<<elseif $leftleg is 0>>
		<<set _feetOptions to "leftFree">>
		<span @class="($lastOptions.feet isnot _feetOptions ?'gold':'')">Your left leg is free.</span>
	<<elseif $rightleg is 0>>
		<<set _feetOptions to "rightFree">>
		<span @class="($lastOptions.feet isnot _feetOptions ?'gold':'')">Your right leg is free.</span>
	<<elseif $leftleg is "grappled" and $rightleg is "grappled">>
		<<set _feetOptions to "grappled">>
		<span @class="($lastOptions.feet isnot _feetOptions ?'gold':'')">Your legs are entangled and forced apart, leaving you less able to protect your <<genitals>>.</span>
	<<elseif $leftleg is "bound" and $rightleg is "bound">>
		<<set _feetOptions to "bound">>
		<span @class="($lastOptions.feet isnot _feetOptions ?'gold':'')">Your legs are bound and forced apart, leaving you less able to protect your <<genitals>>.</span>
	<<else>>
		<<for _i to 0; _i lt $tentacles.max; _i++>>
			<<if $leftleg is $tentacles[_i].id>>
				<<set _feetOptions to "tentacle">>
				<<set _tentacleFeetOption to $tentacles[_i].id>>
				<span @class="($lastOptions.feet isnot _feetOptions ?'gold':'')">You hold the $tentacles[_i].desc tentacle between your feet.</span>
				<<break>>
			<</if>>
		<</for>>
	<</if>>
	<<feetActionsTentacle>>
	<<if Object.keys(_feetaction).length gt 0>>
		<<if Object.values(_feetaction).includes($feetactiondefault) is false or $args[0] is true or ["rest","feetgrab"].includes($feetactiondefault)>>
			<<set _defaultsCombatAction to "feetaction">>
			<<set _actionsSet to $actionDefaults.Tentacles[$defaultsCombatType][_defaultsCombatAction]>>
			<<set _pass to false>>
			<<for _set to 0; _set lt $maxDefaultActionSets; _set++>>
				<<if ["feetgrab"].includes(_actionsSet[_set]) and $feetactionTarget isnot undefined>>
					<<for _i to 0; _i lt $tentacles.max; _i++>>
						<<if $tentacles[_i].shaft isnot "finished">>
							<<if $regrab and $tentacles[_i].head is 0>>
								<<set $feetactiondefault to clone(_actionsSet[_set])>>
								<<set $feetactionTarget to $tentacles[_i].id>>
								<<set _pass to true>>
								<<break>>
							<<elseif $tentacles[_i].head is 0>>
								<<set $feetactiondefault to clone(_actionsSet[_set])>>
								<<set _pass to true>>
							<</if>>
							<<if $regrab is false>>
								<<break>>
							<</if>>
						<</if>>
					<</for>>
				<<elseif ["feetrub","showpenis","showvagina","showbottom"].includes(_actionsSet[_set]) and _tentacleFeetOption isnot undefined>>
					<<if Object.values(_feetaction).includes(_actionsSet[_set] + _tentacleFeetOption)>>
						<<set $feetactiondefault to clone(_actionsSet[_set] + _tentacleFeetOption)>>
						<<set _pass to true>>
						<<break>>
					<</if>>
				<<elseif Object.values(_feetaction).includes(_actionsSet[_set])>>
					<<set $feetactiondefault to clone(_actionsSet[_set])>>
					<<set _pass to true>>
					<<break>>
				<</if>>
			<</for>>
			<<if _pass is false>>
				<<set $feetactiondefault to Object.values(_feetaction)[0]>>
			<</if>>
		<</if>>
		<<set $feetaction to $feetactiondefault>>
		<<set _textColor to combatListColor('feetaction', (Object.values(_feetaction).includes($feetaction) ? $feetaction : Object.values(_feetaction)[0]), "Tentacle")>>
		<div class="extraMargin">
			<<set _availableContext to ["free","leftFree","rightFree"]>>
			<<if $combatControls isnot "radio" and _availableContext.includes(_feetOptions)>>
				<<set _reducedWidths to true>>
			<<else>>
				<<set _reducedWidths to false>>
			<</if>>
			<<generateCombatActionTentacle _feetaction "feetaction" _textColor $feetaction _reducedWidths>>
			<<if _availableContext.includes(_feetOptions) and $tentacles.active gt 0>>
				<<feetactionSetupTentacle>>
			<</if>>
		</div>
		<<if $combatControls.includes("ists")>>
			<div id="feetactionDifficulty">
				<<feetactionDifficultyTentacle>>
			</div>
		<</if>>
	<</if>>
	<<set $lastOptions.feet to clone(_feetOptions)>>
<</nobr>><</widget>>

<<widget "feetactionSetupTentacle">><<nobr>>
<<if $combatControls is "radio">>
	<br><br>
	<<set _first to true>>
	<<if $regrab>>
		<<for _i to 0; _i lt $tentacles.max; _i++>>
			<<if $tentacles[_i] isnot undefined>>
				<<if $tentacles[_i].shaft isnot "finished" and $tentacles[_i].id is $feetactionTarget>>
					<<set _first to false>>
					<<set $_found to $tentacles[_i].id>>
					<<break>>
				<</if>>
			<</if>>
		<</for>>
	<</if>>
	<<for _i to 0; _i lt $tentacles.max; _i++>>
		<<if $tentacles[_i] isnot undefined>>
			<<if $tentacles[_i].shaft isnot "finished">>
				<label>
					<<print '<<radiobutton "$feetactionTarget" "'+$tentacles[_i].id+'" ' + (_first is true or $tentacles[_i].id is $_found ? "checked" : "") + '>>'>>
					$tentacles[_i].fullDesc
				</label> |
				<<set _first to false>>
			<</if>>
		<</if>>
	<</for>>
<<else>>
	<<if _availableTargets is undefined>>
		<<if $controls is "radio">>
			<br>
		<</if>>
		<<set _availableTargets to {}>>
		<<for _i to 0; _i lt $tentacles.max; _i++>>
			<<if $tentacles[_i] isnot undefined>>
				<<if $tentacles[_i].shaft isnot "finished">>
					<<set _availableTargets[$tentacles[_i].desc+" tentacle"] to $tentacles[_i].id>>
					<<set _tentacle_targets_available to true>>
				<</if>>
			<</if>>
		<</for>>
	<</if>>
	<<if _tentacle_targets_available>>
		<span @class="'whiteList ' + (_reducedWidths is true? 'reducedWidth':'')">
			<<listbox "$feetactionTarget" autoselect>>
				<<optionsfrom _availableTargets>>
			<</listbox>>
		</span>
	<</if>>
<</if>>
<</nobr>><</widget>>

<<widget "feetactionDifficultyTentacle">><<nobr>>
<<if $args[0] is undefined>>
	<<set _diffAction to $feetaction>>
<<else>>
	<<set _diffAction to $args[0]>>
<</if>>
<<switch (""+_diffAction).replace(/\d+/g,'')>>
	<<case "showbottomtentacle" "showthighstentacle" "showpenistentacle" "showvaginatentacle">><<deviant5>>
<</switch>>
<</nobr>><</widget>>

<<widget "feetActionsTentacle">><<nobr>>
/*Generate Actions*/
<<set _feetaction to {}>>
<<set _feetaction["Rest"] to "rest">>
<<switch _feetOptions>>
	<<case "free">>
		<<if $tentacles.active gt 0>>
			<<if $consensual is 0>>
				<<set _feetaction["Kick the"] to "feethit">>
			<</if>>
			<<set _feetaction["Grab the"] to "feetgrab">>
		<</if>>
	<<case "leftFree" "rightFree">>
		<<if $tentacles.active gt 0>>
			<<if $consensual is 0>>
				<<set _feetaction["Kick the"] to "feethit">>
			<</if>>
		<</if>>
	<<case "tentacle">>
		<<set _feetaction["Milk it"] to "feetrub"+_tentacleFeetOption>>
		<<set _feetaction["Let go"] to "feetstop"+_tentacleFeetOption>>
		<<if $deviancy gte 75>>
			<<if $penisexist is 1 and $penisuse is 0>>
				<<set _feetaction["Guide to your penis"] to "showpenis"+_tentacleFeetOption>>
			<</if>>
			<<if $vaginaexist is 1 and $vaginause is 0>>
				<<set _feetaction["Guide to your pussy"] to "showvagina"+_tentacleFeetOption>>
			<</if>>
			<<if $anususe is 0 and $analdisable is "f">>
				<<set _feetaction["Guide to your ass"] to "showbottom"+_tentacleFeetOption>>
			<</if>>
			/* Old control
			<<if ($vaginaexist is 1 and $vaginause is 0) or ($penisexist is 1 and $penisuse is 0)>>
				<<set _feetaction["Guide to your thighs"] to "showthighs"+_tentacleFeetOption>>
			<</if>>*/
		<</if>>
<</switch>>
<</nobr>><</widget>>

<<widget "mouthActionInitTentacle">><<nobr>>
	<<for _i to 0; _i lt $tentacles.max; _i++>>
		<<switch $mouthstate>>
			<<case "tentacleentrance">>
				<<if $tentacles[_i].head is "mouthentrance">>
					<<set _mouthOptions to "entrance">>
					<<set _tentacleMouthOption to $tentacles[_i].id>>
					<span @class="($lastOptions.mouth isnot _mouthOptions ?'gold':'')">The $tentacles[_i].desc tentacle threatens your mouth.</span>
					<<break>>
				<</if>>
			<<case "tentacleimminent">>
				<<if $tentacles[_i].head is "mouthimminent">>
					<<set _mouthOptions to "imminent">>
					<<set _tentacleMouthOption to $tentacles[_i].id>>
					<span @class="($lastOptions.mouth isnot _mouthOptions ?'gold':'')">The $tentacles[_i].desc tentacle presses against your mouth.</span>
					<<break>>
				<</if>>
			<<case "tentacle">>
				<<if $tentacles[_i].head is "mouth">>
					<<set _mouthOptions to "penetrated">>
					<<set _tentacleMouthOption to $tentacles[_i].id>>
					<span @class="($lastOptions.mouth isnot _mouthOptions ?'gold':'')">The $tentacles[_i].desc tentacle thrusts into your mouth.</span>
					<<break>>
				<</if>>
			<<case "tentacledeep">>
				<<if $tentacles[_i].head is "mouthdeep">>
					<<set _mouthOptions to "penetrated">>
					<<set _tentacleMouthOption to $tentacles[_i].id>>
					<span @class="($lastOptions.mouth isnot _mouthOptions ?'gold':'')">The $tentacles[_i].desc tentacle thrusts into your mouth, ejaculating down your throat.</span>
					<<break>>
				<</if>>
		<</switch>>
	<</for>>
	<<mouthActionsTentacle>>
	<<if Object.keys(_mouthaction).length gt 0>>
		<<if Object.values(_mouthaction).includes($mouthactiondefault) is false or $args[0] is true or $mouthactiondefault is "rest">>
			<<set _defaultsCombatAction to "mouthaction">>
			<<set _actionsSet to $actionDefaults.Tentacles[$defaultsCombatType][_defaultsCombatAction]>>
			<<set _pass to false>>
			<<for _set to 0; _set lt $maxDefaultActionSets; _set++>>
				<<if ["mouthlick","mouthpullaway","mouthkiss","mouthcooperate","mouthbite"].includes(_actionsSet[_set]) and _tentacleMouthOption isnot undefined>>
					<<if Object.values(_mouthaction).includes(_actionsSet[_set] + _tentacleMouthOption)>>
						<<set $mouthactiondefault to clone(_actionsSet[_set] + _tentacleMouthOption)>>
						<<set _pass to true>>
						<<break>>
					<</if>>
				<<elseif Object.values(_mouthaction).includes(_actionsSet[_set])>>
					<<set $mouthactiondefault to clone(_actionsSet[_set])>>
					<<set _pass to true>>
					<<break>>
				<</if>>
			<</for>>
			<<if _pass is false>>
				<<set $mouthactiondefault to Object.values(_mouthaction)[0]>>
			<</if>>
		<</if>>
		<<set $mouthaction to $mouthactiondefault>>
		<<set _textColor to combatListColor('mouthaction', (Object.values(_mouthaction).includes($mouthaction) ? $mouthaction : Object.values(_mouthaction)[0]), "Tentacle")>>
		<div class="extraMargin">
			<<generateCombatActionTentacle _mouthaction "mouthaction" _textColor $mouthaction>>
		</div>
		<<if $combatControls.includes("ists")>>
			<div id="mouthactionDifficulty">
				<<mouthactionDifficultyTentacle>>
			</div>
		<</if>>
	<</if>>
	<<set $lastOptions.mouth to clone(_mouthOptions)>>
<</nobr>><</widget>>

<<widget "mouthactionDifficultyTentacle">><<nobr>>
/*
<<if $args[0] is undefined>>
	<<set _diffAction to $mouthaction>>
<<else>>
	<<set _diffAction to $args[0]>>
<</if>>
<<switch (""+_diffAction).replace(/\d+/g,'')>>

<</switch>>
*/
<</nobr>><</widget>>

<<widget "mouthActionsTentacle">><<nobr>>
/*Generate Actions*/
<<set _mouthaction to {}>>
<<switch _mouthOptions>>
	<<case "entrance">>
		<<set _mouthaction["Rest"] to "rest">>
		<<set _mouthaction["Lick it"] to "mouthlick"+_tentacleMouthOption>>
		<<if $head isnot "grappled">>
			<<set _mouthaction["Pull away"] to "mouthpullaway"+_tentacleMouthOption>>
		<</if>>
	<<case "imminent">>
		<<set _mouthaction["Rest"] to "rest">>
		<<set _mouthaction["Kiss it"] to "mouthkiss"+_tentacleMouthOption>>
		<<if $head isnot "grappled">>
			<<set _mouthaction["Pull away"] to "mouthpullaway"+_tentacleMouthOption>>
		<</if>>
	<<case "penetrated">>
		<<set _mouthaction["Take it"] to "take">>
		<<set _mouthaction["Cooperate"] to "mouthcooperate"+_tentacleMouthOption>>
		<<if $consensual is 0>>
			<<set _mouthaction["Bite"] to "mouthbite"+_tentacleMouthOption>>
		<</if>>
<</switch>>
<</nobr>><</widget>>

<<widget "penisActionInitTentacle">><<nobr>>
	<<for _i to 0; _i lt $tentacles.max; _i++>>
		<<switch $penisstate>>
			<<case "tentacleentrance">>
				<<if $tentacles[_i].head is "penisentrance">>
					<<set _penisOptions to "entrance">>
					<<set _tentaclepenisOption to $tentacles[_i].id>>
					<span @class="($lastOptions.penis isnot _penisOptions ?'gold':'')">The $tentacles[_i].desc tentacle threatens your <<penis>>.</span>
					<<break>>
				<</if>>
			<<case "tentacleimminent">>
				<<if $tentacles[_i].head is "penisimminent">>
					<<set _penisOptions to "imminent">>
					<<set _tentaclepenisOption to $tentacles[_i].id>>
					<span @class="($lastOptions.penis isnot _penisOptions ?'gold':'')">The $tentacles[_i].desc tentacle presses against your <<penis>>, about to engulf</span>
					<<break>>
				<</if>>
			<<case "tentacle">>
				<<if $tentacles[_i].head is "penis">>
					<<set _penisOptions to "penetrated">>
					<<set _tentaclepenisOption to $tentacles[_i].id>>
					<span @class="($lastOptions.penis isnot _penisOptions ?'gold':'')">The $tentacles[_i].desc tentacle envelops and pounds your <<penis>>.</span>
					<<break>>
				<</if>>
			<<case "tentacledeep">>
				<<if $tentacles[_i].head is "penisdeep">>
					<<set _penisOptions to "penetrated">>
					<<set _tentaclepenisOption to $tentacles[_i].id>>
					<span @class="($lastOptions.penis isnot _penisOptions ?'gold':'')">The $tentacles[_i].desc tentacle envelops and pounds your <<penis>>.</span>
					<<break>>
				<</if>>
			<<case "tentaclerub">>
				<<if $tentacles[_i].head is "penisrub">>
					<<set _penisOptions to "penisrub">>
					<<set _tentaclepenisOption to $tentacles[_i].id>>
					<span @class="($lastOptions.penis isnot _penisOptions ?'gold':'')">The $tentacles[_i].desc tentacle runs between your thighs, coiling around your <<penis>> and pressing against your tummy.</span>
					<<break>>
				<</if>>
		<</switch>>
	<</for>>
	<<penisActionsTentacle>>
	<<if Object.keys(_penisaction).length gt 0>>
		<<if Object.values(_penisaction).includes($penisactiondefault) is false or $args[0] is true or $penisactiondefault is "rest">>
			<<set _defaultsCombatAction to "penisaction">>
			<<set _actionsSet to $actionDefaults.Tentacles[$defaultsCombatType][_defaultsCombatAction]>>
			<<set _pass to false>>
			<<for _set to 0; _set lt $maxDefaultActionSets; _set++>>
				<<if ["penisrub","penispullaway","peniscooperate"].includes(_actionsSet[_set]) and _tentaclepenisOption isnot undefined>>
					<<if Object.values(_penisaction).includes(_actionsSet[_set] + _tentaclepenisOption)>>
						<<set $penisactiondefault to clone(_actionsSet[_set] + _tentaclepenisOption)>>
						<<set _pass to true>>
						<<break>>
					<</if>>
				<<elseif Object.values(_penisaction).includes(_actionsSet[_set])>>
					<<set $penisactiondefault to clone(_actionsSet[_set])>>
					<<set _pass to true>>
					<<break>>
				<</if>>
			<</for>>
			<<if _pass is false>>
				<<set $penisactiondefault to Object.values(_penisaction)[0]>>
			<</if>>
		<</if>>
		<<set $penisaction to $penisactiondefault>>
		<<set _textColor to combatListColor('penisaction', (Object.values(_penisaction).includes($penisaction) ? $penisaction : Object.values(_penisaction)[0]), "Tentacle")>>
		<div class="extraMargin">
			<<generateCombatActionTentacle _penisaction "penisaction" _textColor $penisaction>>
		</div>
		<<if $combatControls.includes("ists")>>
			<div id="penisactionDifficulty">
				<<penisactionDifficultyTentacle>>
			</div>
		<</if>>
	<</if>>
	<<set $lastOptions.penis to clone(_penisOptions)>>
<</nobr>><</widget>>

<<widget "penisactionDifficultyTentacle">><<nobr>>
/*
<<if $args[0] is undefined>>
	<<set _diffAction to $penisaction>>
<<else>>
	<<set _diffAction to $args[0]>>
<</if>>
<<switch (""+_diffAction).replace(/\d+/g,'')>>

<</switch>>
*/
<</nobr>><</widget>>

<<widget "penisActionsTentacle">><<nobr>>
/*Generate Actions*/
<<set _penisaction to {}>>
<<switch _penisOptions>>
	<<case "entrance" "imminent">>
		<<set _penisaction["Rest"] to "rest">>
		<<set _penisaction["Rub"] to "penisrub"+_tentaclepenisOption>>
		<<if $leftleg isnot "grappled" or $rightleg isnot "grappled">>
			<<set _penisaction["Pull away"] to "penispullaway"+_tentaclepenisOption>>
		<</if>>
	<<case "penetrated">>
		<<set _penisaction["Take it"] to "take">>
		<<set _penisaction["Cooperate"] to "peniscooperate"+_tentaclepenisOption>>
	<<case "penisrub">>
		<<set _penisaction["Rest"] to "rest">>
		<<set _penisaction["Rub"] to "penisrub"+_tentaclepenisOption>>
<</switch>>
<</nobr>><</widget>>

<<widget "vaginaActionInitTentacle">><<nobr>>
	<<for _i to 0; _i lt $tentacles.max; _i++>>
		<<switch $vaginastate>>
			<<case "tentacleentrance">>
				<<if $tentacles[_i].head is "vaginaentrance">>
					<<set _vaginaOptions to "entrance">>
					<<set _tentaclevaginaOption to $tentacles[_i].id>>
					<span @class="($lastOptions.right isnot _rightOptions ?'gold':'')">The $tentacles[_i].desc tentacle threatens your <<pussy>>.</span>
					<<break>>
				<</if>>
			<<case "tentacleimminent">>
				<<if $tentacles[_i].head is "vaginaimminent">>
					<<set _vaginaOptions to "imminent">>
					<<set _tentaclevaginaOption to $tentacles[_i].id>>
					<span @class="($lastOptions.vagina isnot _vaginaOptions ?'gold':'')">The $tentacles[_i].desc tentacle presses against your <<pussy>>, about to penetrate</span>
					<<break>>
				<</if>>
			<<case "tentacle">>
				<<if $tentacles[_i].head is "vagina">>
					<<set _vaginaOptions to "penetrated">>
					<<set _tentaclevaginaOption to $tentacles[_i].id>>
					<span @class="($lastOptions.vagina isnot _vaginaOptions ?'gold':'')">The $tentacles[_i].desc tentacle thrusts into your <<pussy>>.</span>
					<<break>>
				<</if>>
			<<case "tentacledeep">>
				<<if $tentacles[_i].head is "vaginadeep">>
					<<set _vaginaOptions to "penetrated">>
					<<set _tentaclevaginaOption to $tentacles[_i].id>>
					<span @class="($lastOptions.vagina isnot _vaginaOptions ?'gold':'')">The $tentacles[_i].desc tentacle thrusts into your <<pussy>>, ejaculating deep into your womb.</span>
					<<break>>
				<</if>>
			<<case "tentaclerub">>
				<<if $tentacles[_i].head is "tentaclerub">>
					<<set _vaginaOptions to "vaginarub">>
					<<set _tentaclevaginaOption to $tentacles[_i].id>>
					<span @class="($lastOptions.vagina isnot _vaginaOptions ?'gold':'')">The $tentacles[_i].desc tentacle runs between your thighs, pressing against your labia and continuing to your tummy.</span>
					<<break>>
				<</if>>
		<</switch>>
	<</for>>
	<<vaginaActionsTentacle>>
	<<if Object.keys(_vaginaaction).length gt 0>>
		<<if Object.values(_vaginaaction).includes($vaginaactiondefault) is false or $args[0] is true or $vaginaactiondefault is "rest">>
			<<set _defaultsCombatAction to "vaginaaction">>
			<<set _actionsSet to $actionDefaults.Tentacles[$defaultsCombatType][_defaultsCombatAction]>>
			<<set _pass to false>>
			<<for _set to 0; _set lt $maxDefaultActionSets; _set++>>
				<<if ["vaginarub","vaginapullaway","vaginacooperate"].includes(_actionsSet[_set]) and _tentaclevaginaOption isnot undefined>>
					<<if Object.values(_vaginaaction).includes(_actionsSet[_set] + _tentaclevaginaOption)>>
						<<set $vaginaactiondefault to clone(_actionsSet[_set] + _tentaclevaginaOption)>>
						<<set _pass to true>>
						<<break>>
					<</if>>
				<<elseif Object.values(_vaginaaction).includes(_actionsSet[_set])>>
					<<set $vaginaactiondefault to clone(_actionsSet[_set])>>
					<<set _pass to true>>
					<<break>>
				<</if>>
			<</for>>
			<<if _pass is false>>
				<<set $vaginaactiondefault to Object.values(_vaginaaction)[0]>>
			<</if>>
		<</if>>
		<<set $vaginaaction to $vaginaactiondefault>>
		<<set _textColor to combatListColor('vaginaaction', (Object.values(_vaginaaction).includes($vaginaaction) ? $vaginaaction : Object.values(_vaginaaction)[0]), "Tentacle")>>
		<div class="extraMargin">
			<<generateCombatActionTentacle _vaginaaction "vaginaaction" _textColor $vaginaaction>>
		</div>
		<<if $combatControls.includes("ists")>>
			<div id="vaginaactionDifficulty">
				<<vaginaactionDifficultyTentacle>>
			</div>
		<</if>>
	<</if>>
	<<set $lastOptions.vagina to clone(_vaginaOptions)>>
<</nobr>><</widget>>

<<widget "vaginaactionDifficultyTentacle">><<nobr>>
/*
<<if $args[0] is undefined>>
	<<set _diffAction to $vaginaaction>>
<<else>>
	<<set _diffAction to $args[0]>>
<</if>>
<<switch (""+_diffAction).replace(/\d+/g,'')>>

<</switch>>
*/
<</nobr>><</widget>>

<<widget "vaginaActionsTentacle">><<nobr>>
/*Generate Actions*/
<<set _vaginaaction to {}>>
<<switch _vaginaOptions>>
	<<case "entrance" "imminent">>
		<<set _vaginaaction["Rest"] to "rest">>
		<<set _vaginaaction["Rub"] to "vaginarub"+_tentaclevaginaOption>>
		<<if $leftleg isnot "grappled" or $rightleg isnot "grappled">>
			<<set _vaginaaction["Pull away"] to "vaginapullaway"+_tentaclevaginaOption>>
		<</if>>
	<<case "penetrated">>
		<<set _vaginaaction["Take it"] to "take">>
		<<set _vaginaaction["Cooperate"] to "vaginacooperate"+_tentaclevaginaOption>>
	<<case "vaginarub">>
		<<set _vaginaaction["Rest"] to "rest">>
		<<set _vaginaaction["Rub"] to "vaginarub"+_tentaclevaginaOption>>
<</switch>>
<</nobr>><</widget>>

<<widget "anusActionInitTentacle">><<nobr>>
	<<for _i to 0; _i lt $tentacles.max; _i++>>
		<<switch $anusstate>>
			<<case "tentacleentrance">>
				<<if $tentacles[_i].head is "anusentrance">>
					<<set _anusOptions to "entrance">>
					<<set _tentacleanusOption to $tentacles[_i].id>>
					<span @class="($lastOptions.anus isnot _anusOptions ?'gold':'')">The $tentacles[_i].desc tentacle threatens your <<bottom>>.</span>
					<<break>>
				<</if>>
			<<case "tentacleimminent">>
				<<if $tentacles[_i].head is "anusimminent">>
					<<set _anusOptions to "imminent">>
					<<set _tentacleanusOption to $tentacles[_i].id>>
					<span @class="($lastOptions.anus isnot _anusOptions ?'gold':'')">The $tentacles[_i].desc tentacle presses against your <<bottom>>, about to penetrate.</span>
					<<break>>
				<</if>>
			<<case "tentacle">>
				<<if $tentacles[_i].head is "anus">>
					<<set _anusOptions to "penetrated">>
					<<set _tentacleanusOption to $tentacles[_i].id>>
					<span @class="($lastOptions.anus isnot _anusOptions ?'gold':'')">The $tentacles[_i].desc tentacle thrusts into your <<bottom>>.</span>
					<<break>>
				<</if>>
			<<case "tentacledeep">>
				<<if $tentacles[_i].head is "anusdeep">>
					<<set _anusOptions to "penetrated">>
					<<set _tentacleanusOption to $tentacles[_i].id>>
					<span @class="($lastOptions.anus isnot _anusOptions ?'gold':'')">The $tentacles[_i].desc tentacle thrusts into your <<bottom>>, ejaculating deep into your bowels.</span>
					<<break>>
				<</if>>
			<<case "tentaclerub">>
				<<if $tentacles[_i].head is "anusrub">>
					<<set _anusOptions to "anusrub">>
					<<set _tentacleanusOption to $tentacles[_i].id>>
					<span @class="($lastOptions.anus isnot _anusOptions ?'gold':'')">The $tentacles[_i].desc tentacle rubs itself between your butt cheeks.</span>
					<<break>>
				<</if>>
		<</switch>>
	<</for>>
	<<anusActionsTentacle>>
	<<if Object.keys(_anusaction).length gt 0>>
		<<if Object.values(_anusaction).includes($anusactiondefault) is false or $args[0] is true or $anusactiondefault is "rest">>
			<<set _defaultsCombatAction to "anusaction">>
			<<set _actionsSet to $actionDefaults.Tentacles[$defaultsCombatType][_defaultsCombatAction]>>
			<<set _pass to false>>
			<<for _set to 0; _set lt $maxDefaultActionSets; _set++>>
				<<if ["anusrub","anuspullaway","anuscooperate"].includes(_actionsSet[_set]) and _tentacleanusOption isnot undefined>>
					<<if Object.values(_anusaction).includes(_actionsSet[_set] + _tentacleanusOption)>>
						<<set $anusactiondefault to clone(_actionsSet[_set] + _tentacleanusOption)>>
						<<set _pass to true>>
						<<break>>
					<</if>>
				<<elseif Object.values(_anusaction).includes(_actionsSet[_set])>>
					<<set $anusactiondefault to clone(_actionsSet[_set])>>
					<<set _pass to true>>
					<<break>>
				<</if>>
			<</for>>
			<<if _pass is false>>
				<<set $anusactiondefault to Object.values(_anusaction)[0]>>
			<</if>>
		<</if>>
		<<set $anusaction to $anusactiondefault>>
		<<set _textColor to combatListColor('anusaction', (Object.values(_anusaction).includes($anusaction) ? $anusaction : Object.values(_anusaction)[0]), "Tentacle")>>
		<div class="extraMargin">
			<<generateCombatActionTentacle _anusaction "anusaction" _textColor $anusaction>>
		</div>
		<<if $combatControls.includes("ists")>>
			<div id="anusactionDifficulty">
				<<anusactionDifficultyTentacle>>
			</div>
		<</if>>
	<</if>>
	<<set $lastOptions.anus to clone(_anusOptions)>>
<</nobr>><</widget>>

<<widget "anusactionDifficultyTentacle">><<nobr>>
/*
<<if $args[0] is undefined>>
	<<set _diffAction to $anusaction>>
<<else>>
	<<set _diffAction to $args[0]>>
<</if>>
<<switch (""+_diffAction).replace(/\d+/g,'')>>

<</switch>>
*/
<</nobr>><</widget>>

<<widget "anusActionsTentacle">><<nobr>>
/*Generate Actions*/
<<set _anusaction to {}>>
<<switch _anusOptions>>
	<<case "entrance" "imminent">>
		<<set _anusaction["Rest"] to "rest">>
		<<set _anusaction["Rub"] to "anusrub"+_tentacleanusOption>>
		<<if $leftleg isnot "grappled" or $rightleg isnot "grappled">>
			<<set _anusaction["Pull away"] to "anuspullaway"+_tentacleanusOption>>
		<</if>>
	<<case "penetrated">>
		<<set _anusaction["Take it"] to "take">>
		<<set _anusaction["Cooperate"] to "anuscooperate"+_tentacleanusOption>>
	<<case "anusrub">>
		<<set _anusaction["Rest"] to "rest">>
		<<set _anusaction["Rub"] to "anusrub"+_tentacleanusOption>>
<</switch>>
<</nobr>><</widget>>

<<widget "chestActionInitTentacle">><<nobr>>
	<<for _i to 0; _i lt $tentacles.max; _i++>>
		<<switch $chestuse>>
			<<case "tentaclerub">>
				<<if $tentacles[_i].head is "chestrub">>
					<<set _chestOptions to "entrance">>
					<<set _tentaclechestOption to $tentacles[_i].id>>
					<span @class="($lastOptions.chest isnot _chestOptions ?'gold':'')">The $tentacles[_i].desc tentacle rubs itself between your chest.</span>
					<<break>>
				<</if>>
		<</switch>>
	<</for>>
	<<chestActionsTentacle>>
	<<if Object.keys(_chestaction).length gt 0>>
		<<if $chestactiondefault is 0 or Object.values(_chestaction).includes($chestactiondefault) is false>>
			<<set $chestactiondefault to Object.values(_chestaction)[0]>>
		<</if>>
		<<set $chestaction to $chestactiondefault>>
		<<set _textColor to combatListColor('chestaction', (Object.values(_chestaction).includes($chestaction) ? $chestaction : Object.values(_chestaction)[0]), "Tentacle")>>
		<div class="extraMargin">
			<<generateCombatActionTentacle _chestaction "chestaction" _textColor $chestaction>>
		</div>
		<<if $combatControls.includes("ists")>>
			<div id="chestactionDifficulty">
				<<chestactionDifficultyTentacle>>
			</div>
		<</if>>
	<</if>>
	<<set $lastOptions.chest to clone(_chestOptions)>>
<</nobr>><</widget>>

<<widget "chestactionDifficultyTentacle">><<nobr>>
/*
<<if $args[0] is undefined>>
	<<set _diffAction to $chestaction>>
<<else>>
	<<set _diffAction to $args[0]>>
<</if>>
<<switch (""+_diffAction).replace(/\d+/g,'')>>

<</switch>>
*/
<</nobr>><</widget>>

<<widget "chestActionsTentacle">><<nobr>>
/*Generate Actions*/
<<set _chestaction to {}>>
<<switch _chestOptions>>
	<<case "chestrub">>
		<<set _chestaction["Rest"] to "rest">>
		<<set _chestaction["Rub"] to "chestrub"+_tentaclechestOption>>
<</switch>>
<</nobr>><</widget>>