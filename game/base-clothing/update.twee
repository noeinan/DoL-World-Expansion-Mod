:: Widgets updateClothes [widget]
<<widget "updateClothes">><<nobr>>

<<set _equip to ["upper", "lower", "under_upper", "under_lower","head", "face", "neck", "legs", "feet", "genitals"]>>
<<set _skip to ["integrity","integrity_max","colour","accessory_colour", "exposed", "vagina_exposed", "anus_exposed", "anal_shield", "one_piece", "skirt_down", "state", "state_top"]>>

<<for _i to 0; _i lt _equip.length; _i++>>
	<<set _worn to $worn[_equip[_i]]>>
	<<set _default to setup.clothes[_equip[_i]][_worn.index]>>
	<<set _keys to Object.keys(_default)>>
	<<for _j to 0; _j lt _keys.length; _j++>>
		<<if _skip.includes(_keys[_j])>>
			<<continue>>
		<</if>>
		<<set _worn[_keys[_j]] to clone(_default[_keys[_j]])>>
	<</for>>

	<<if _equip[_i] is "genitals">>
		<<continue>>
	<</if>>

	<<set _carried to $carried[_equip[_i]]>>
	<<set _default to setup.clothes[_equip[_i]][_carried.index]>>
	<<set _keys to Object.keys(_default)>>
	<<for _j to 0; _j lt _keys.length; _j++>>
		<<if _skip.includes(_keys[_j])>>
			<<continue>>
		<</if>>
		<<set _carried[_keys[_j]] to clone(_default[_keys[_j]])>>
	<</for>>

	<<for _j to 0; _j lt $wardrobe[_equip[_i]].length; _j++>>
		<<set _wardrobe to $wardrobe[_equip[_i]][_j]>>
		<<set _default to setup.clothes[_equip[_i]][_wardrobe.index]>>
		<<set _keys to Object.keys(_default)>>
		<<for _k to 0; _k lt _keys.length; _k++>>
			<<if _skip.includes(_keys[_k])>>
				<<continue>>
			<</if>>
			<<set _wardrobe[_keys[_k]] to clone(_default[_keys[_k]])>>
		<</for>>
	<</for>>
<</for>>

<</nobr>><</widget>>